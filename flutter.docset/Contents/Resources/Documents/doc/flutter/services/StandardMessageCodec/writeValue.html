<!DOCTYPE html><html lang="en"><head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no"/>
  <meta name="description" content="API docs for the writeValue method from the StandardMessageCodec class, for the Dart programming language."/>
  <title>writeValue method - StandardMessageCodec class - services library - Dart API</title>

  <!-- required because all the links are pseudo-absolute -->
  <base href="../../"/>

  
  <link rel="preconnect" href="https://fonts.gstatic.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,300;0,400;0,500;0,700;1,400&amp;display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" rel="stylesheet"/>
  
  <link rel="stylesheet" href="static-assets/github.css?v1"/>
  <link rel="stylesheet" href="static-assets/styles.css?v1"/>
  <link rel="icon" href="static-assets/favicon.png?v1"/>

  <!-- style overrides for dartdoc -->
<style>
@import 'https://fonts.googleapis.com/css?family=Roboto:500,400italic,300,400,100i';
@import 'https://fonts.googleapis.com/css?family=Google+Sans:500,400italic,300,400,100i';
@import 'https://fonts.googleapis.com/css?family=Open+Sans:500,400italic,300,400,100i';
@import 'https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Sharp|Material+Icons+Round';
</style>

<link href="https://flutter.github.io/assets-for-api-docs/assets/cupertino/cupertino.css" rel="stylesheet" type="text/css"/>

<link href="../assets/overrides.css" rel="stylesheet" type="text/css"/>

<link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Sharp|Material+Icons+Round" rel="stylesheet"/>
<style>
  /* Rule for sizing the icon. */
  .md-36 { font-size: 36px; }
</style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67589403-1', 'auto');
  ga('send', 'pageview');
</script>

<script async="" defer="" src="../assets/api_survey.js"></script>

<!-- Styles and scripting for handling custom code snippets -->
<link href="../assets/snippets.css" rel="stylesheet" type="text/css"/>
<script src="../assets/snippets.js"></script>

<link rel="search" type="application/opensearchdescription+xml" title="Flutter API" href="opensearch.xml"/>

</head>


<body data-base-href="../../" data-using-base-href="true" class="light-theme">

<div id="overlay-under-drawer"></div>

<header id="title">
  <span id="sidenav-left-toggle" class="material-symbols-outlined" role="button" tabindex="0">menu</span>
  <ol class="breadcrumbs gt-separated dark hidden-xs">
    <li><a href="index.html">Flutter</a></li>
    <li><a href="services/services-library.html">services</a></li>
    <li><a href="services/StandardMessageCodec-class.html">StandardMessageCodec</a></li>
    <li class="self-crumb">writeValue method</li>
  </ol>
  <div class="self-name">writeValue</div>
  <form class="search navbar-right" role="search">
    <input type="text" id="search-box" autocomplete="off" disabled="" class="form-control typeahead" placeholder="Loading search..."/>
  </form>
  <div class="toggle" id="theme-button">
    <label for="theme">
      <input type="checkbox" id="theme" value="light-theme"/>
      <span class="material-symbols-outlined">
        brightness_4
      </span>
    </label>
  </div>
</header>
<main>

  <div id="dartdoc-main-content" class="main-content">
      <div>
  <div id="external-links" class="btn-group"><a title="View source code" class="source-link" href="https://github.com/flutter/flutter/blob/master/packages/flutter/lib/src/services/message_codecs.dart#L387"><span class="material-symbols-outlined">description</span></a></div>
<h1><a class="dashingAutolink" name="autolink-59050"></a><a class="dashAnchor" name="//apple_ref/cpp/Method/writeValue"></a><span class="kind-method">writeValue</span> method 
    <a href="https://dart.dev/null-safety" class="feature feature-null-safety" title="Supports the null safety language feature.">Null safety</a>
</h1></div>

    <section class="multi-line-signature">
      

<span class="returntype">void</span>
<span class="name ">writeValue</span>(<wbr/><ol class="parameter-list"><li><span class="parameter" id="writeValue-param-buffer"><span class="type-annotation"><a href="foundation/WriteBuffer-class.html">WriteBuffer</a></span> <span class="parameter-name">buffer</span>, </span></li>
<li><span class="parameter" id="writeValue-param-value"><span class="type-annotation"><a href="dart-core/Object-class.html">Object</a>?</span> <span class="parameter-name">value</span></span></li>
</ol>)

      

    </section>
    
<section class="desc markdown">
  <p>Writes <code>value</code> to <code>buffer</code> by first writing a type discriminator
byte, then the value itself.</p>
<p>This method may be called recursively to serialize container values.</p>
<p>Type discriminators 0 through 127 inclusive are reserved for use by the
base class, as follows:</p>
<ul>
<li>null = 0</li>
<li>true = 1</li>
<li>false = 2</li>
<li>32 bit integer = 3</li>
<li>64 bit integer = 4</li>
<li>larger integers = 5 (see below)</li>
<li>64 bit floating-point number = 6</li>
<li>String = 7</li>
<li>Uint8List = 8</li>
<li>Int32List = 9</li>
<li>Int64List = 10</li>
<li>Float64List = 11</li>
<li>List = 12</li>
<li>Map = 13</li>
<li>Float32List = 14</li>
<li>Reserved for future expansion: 15..127</li>
</ul>
<p>The codec can be extended by overriding this method, calling super
for values that the extension does not handle. Type discriminators
used by extensions must be greater than or equal to 128 in order to avoid
clashes with any later extensions to the base class.</p>
<p>The &#34;larger integers&#34; type, 5, is never used by <a href="services/StandardMessageCodec/writeValue.html">writeValue</a>. A subclass
could represent big integers from another package using that type. The
format is first the type byte (0x05), then the actual number as an ASCII
string giving the hexadecimal representation of the integer, with the
string&#39;s length as encoded by <a href="services/StandardMessageCodec/writeSize.html">writeSize</a> followed by the string bytes. On
Android, that would get converted to a <code>java.math.BigInteger</code> object. On
iOS, the string representation is returned.</p>
</section>


    
<section class="summary source-code" id="source">
  <h2><span>Implementation</span></h2>
  <pre class="language-dart"><code class="language-dart">void writeValue(WriteBuffer buffer, Object? value) {
  if (value == null) {
    buffer.putUint8(_valueNull);
  } else if (value is bool) {
    buffer.putUint8(value ? _valueTrue : _valueFalse);
  } else if (value is double) {  // Double precedes int because in JS everything is a double.
                                 // Therefore in JS, both `is int` and `is double` always
                                 // return `true`. If we check int first, we&#39;ll end up treating
                                 // all numbers as ints and attempt the int32/int64 conversion,
                                 // which is wrong. This precedence rule is irrelevant when
                                 // decoding because we use tags to detect the type of value.
    buffer.putUint8(_valueFloat64);
    buffer.putFloat64(value);
  } else if (value is int) { // ignore: avoid_double_and_int_checks, JS code always goes through the `double` path above
    if (-0x7fffffff - 1 &lt;= value &amp;&amp; value &lt;= 0x7fffffff) {
      buffer.putUint8(_valueInt32);
      buffer.putInt32(value);
    } else {
      buffer.putUint8(_valueInt64);
      buffer.putInt64(value);
    }
  } else if (value is String) {
    buffer.putUint8(_valueString);
    final Uint8List asciiBytes = Uint8List(value.length);
    Uint8List? utf8Bytes;
    int utf8Offset = 0;
    // Only do utf8 encoding if we encounter non-ascii characters.
    for (int i = 0; i &lt; value.length; i += 1) {
      final int char = value.codeUnitAt(i);
      if (char &lt;= 0x7f) {
        asciiBytes[i] = char;
      } else {
        utf8Bytes = utf8.encoder.convert(value.substring(i));
        utf8Offset = i;
        break;
      }
    }
    if (utf8Bytes != null) {
      writeSize(buffer, utf8Offset + utf8Bytes.length);
      buffer.putUint8List(Uint8List.sublistView(asciiBytes, 0, utf8Offset));
      buffer.putUint8List(utf8Bytes);
    } else {
      writeSize(buffer, asciiBytes.length);
      buffer.putUint8List(asciiBytes);
    }
  } else if (value is Uint8List) {
    buffer.putUint8(_valueUint8List);
    writeSize(buffer, value.length);
    buffer.putUint8List(value);
  } else if (value is Int32List) {
    buffer.putUint8(_valueInt32List);
    writeSize(buffer, value.length);
    buffer.putInt32List(value);
  } else if (value is Int64List) {
    buffer.putUint8(_valueInt64List);
    writeSize(buffer, value.length);
    buffer.putInt64List(value);
  } else if (value is Float32List) {
    buffer.putUint8(_valueFloat32List);
    writeSize(buffer, value.length);
    buffer.putFloat32List(value);
  } else if (value is Float64List) {
    buffer.putUint8(_valueFloat64List);
    writeSize(buffer, value.length);
    buffer.putFloat64List(value);
  } else if (value is List) {
    buffer.putUint8(_valueList);
    writeSize(buffer, value.length);
    for (final Object? item in value) {
      writeValue(buffer, item);
    }
  } else if (value is Map) {
    buffer.putUint8(_valueMap);
    writeSize(buffer, value.length);
    value.forEach((Object? key, Object? value) {
      writeValue(buffer, key);
      writeValue(buffer, value);
    });
  } else {
    throw ArgumentError.value(value);
  }
}</code></pre>
</section>


  </div> <!-- /.main-content -->

  <div id="dartdoc-sidebar-left" class="sidebar sidebar-offcanvas-left">
    <header id="header-search-sidebar" class="hidden-l">
  <form class="search-sidebar" role="search">
    <input type="text" id="search-sidebar" autocomplete="off" disabled="" class="form-control typeahead" placeholder="Loading search..."/>
  </form>
</header>

<ol class="breadcrumbs gt-separated dark hidden-l" id="sidebar-nav">
  <li><a href="index.html">Flutter</a></li>
  <li><a href="services/services-library.html">services</a></li>
  <li><a href="services/StandardMessageCodec-class.html">StandardMessageCodec</a></li>
  <li class="self-crumb">writeValue method</li>
</ol>


    <h5>StandardMessageCodec class</h5>
    <ol>

        <li class="section-title"><a href="services/StandardMessageCodec-class.html#constructors">Constructors</a></li>
          <li><a href="services/StandardMessageCodec/StandardMessageCodec.html">StandardMessageCodec</a></li>


        <li class="section-title inherited">
          <a href="services/StandardMessageCodec-class.html#instance-properties">Properties</a>
        </li>
          <li class="inherited"><a href="dart-core/Object/hashCode.html">hashCode</a></li>
          <li class="inherited"><a href="dart-core/Object/runtimeType.html">runtimeType</a></li>

        <li class="section-title"><a href="services/StandardMessageCodec-class.html#instance-methods">Methods</a></li>
          <li><a href="services/StandardMessageCodec/decodeMessage.html">decodeMessage</a></li>
          <li><a href="services/StandardMessageCodec/encodeMessage.html">encodeMessage</a></li>
          <li class="inherited"><a href="dart-core/Object/noSuchMethod.html">noSuchMethod</a></li>
          <li><a href="services/StandardMessageCodec/readSize.html">readSize</a></li>
          <li><a href="services/StandardMessageCodec/readValue.html">readValue</a></li>
          <li><a href="services/StandardMessageCodec/readValueOfType.html">readValueOfType</a></li>
          <li class="inherited"><a href="dart-core/Object/toString.html">toString</a></li>
          <li><a href="services/StandardMessageCodec/writeSize.html">writeSize</a></li>
          <li><a href="services/StandardMessageCodec/writeValue.html">writeValue</a></li>

        <li class="section-title inherited"><a href="services/StandardMessageCodec-class.html#operators">Operators</a></li>
          <li class="inherited"><a href="dart-core/Object/operator_equals.html">operator ==</a></li>




</ol>

  </div><!--/.sidebar-offcanvas-->

  <div id="dartdoc-sidebar-right" class="sidebar sidebar-offcanvas-right">
  </div><!--/.sidebar-offcanvas-->

</main>

<footer>
  <span class="no-break">
    Flutter
      0.0.0
  </span>

  <script src="footer.js"></script>
</footer>



<script src="static-assets/highlight.pack.js?v1"></script>
<script src="static-assets/docs.dart.js"></script>







</body></html>